import React, { useEffect, useState } from "react";

/*
  ! === ë¶€ìˆ˜ íš¨ê³¼ (Side Effect) === 
  : ì»´í¬ë„ŒíŠ¸ì˜ 'ì£¼ìš” ê¸°ëŠ¥(ìƒíƒœê´€ë¦¬, UIë Œë”ë§)' ì™¸ì— ë°œìƒí•˜ëŠ” ì‘ì—…
  EX) APIí˜¸ì¶œ, ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡, ìˆ˜ë™ DOM ì¡°ì‘ ë“±

  ! useEffect
  : React í•¨ìˆ˜í˜• ì»´í¬ë„ŒíŠ¸ì—ì„œ ë¶€ìˆ˜ íš¨ê³¼ë¥¼ ìˆ˜í–‰í•˜ê¸° ìœ„í•œ Hook
  - ë°ì´í„° ê°€ì ¸ì˜¤ê¸°, ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ ì‹œ íŠ¹ì • ì‘ì—… ìˆ˜í–‰ ë“±ì— ì‚¬ìš©

  ? React ì»´í¬ë„ŒíŠ¸ì˜ 'ë¼ì´í”„ ì‚¬ì´í´'
    1) ë§ˆìš´íŒ…: ì»´í¬ë„ŒíŠ¸ê°€ DOMì— ì²˜ìŒ ì‚½ì… ë  ë•Œ ì‹¤í–‰
    2) ì—…ë°ì´íŠ¸: ì»´í¬ë„ŒíŠ¸ì˜ ì¬ë Œë”ë§ (ì£¼ë¡œ state, propsì˜ ë³€ê²½ì— ì˜í•´ ë°œìƒ)
    3) ì–¸ë§ˆìš´íŒ…: ì»´í¬ë„ŒíŠ¸ê°€ DOMì—ì„œ ì œê±° ë  ë•Œ ì‹¤í–‰

    useEffect & ë¼ì´í”„ ì‚¬ì´í´
    : ë§ˆìš´íŒ…ê³¼ ì—…ë°ì´íŠ¸ì—ì„œ ì‹¤í–‰í•  ì½”ë“œë¥¼ useEffectì—ì„œ ê´€ë¦¬
    - ì˜ì¡´ì„± ë°°ì—´(deps)ì„ ì‚¬ìš©í•˜ì—¬ ì—…ë°ì´íŠ¸ ì‹œ ë™ì‘ì„ ì œê±°

  ? useEffectì˜ ê¸°ë³¸ êµ¬ì¡°
  : 1-2ê°œì˜ ì¸ì í•„ìš”
    
    1) ì²«ë²ˆì§¸ ì¸ì: ì½œë°± í•¨ìˆ˜(í™”ì‚´í‘œ í•¨ìˆ˜)
    - ë¶€ìˆ˜ íš¨ê³¼ë¥¼ ìˆ˜í–‰í•˜ëŠ” í•¨ìˆ˜

    2) ë‘ë²ˆì§¸ ì¸ì: ì˜ì¡´ì„± ë°°ì—´, deps
    - í•´ë‹¹ ë°°ì—´ ê°’ì´ ë³€ê²½ë  ë•Œ ë§ˆë‹¤ ë¶€ìˆ˜ íš¨ê³¼ê°€ ë‹¤ì‹œ ì‹¤í–‰
    cf) ë¹ˆ ë°°ì—´ - ì»´í¬ë„ŒíŠ¸ê°€ ë§ˆìš´íŠ¸ ë  ë•Œ í•œë²ˆë§Œ ì‹¤í–‰
        +) ì˜ì¡´ì„± ë°°ì—´ì— ê°’ì´ ìˆë”ë¼ë„ ë§ˆìš´íŠ¸ ì‹œì—ëŠ” ë°˜ë“œì‹œ ì‹¤í–‰

  useEffect(() => {
    -ë¶€ìˆ˜ íš¨ê³¼-

    ? useEffectì˜ ì •ë¦¬ í•¨ìˆ˜
    : useEffectì—ì„œ í•¨ìˆ˜ë¥¼ returní•˜ë©´ í•´ë‹¹ í•¨ìˆ˜ëŠ” ì»´í¬ë„ŒíŠ¸ê°€ í™”ë©´ì—ì„œ ì‚¬ë¼ì§ˆ ë•Œ(ì–¸ë§ˆìš´íŠ¸) ì‹¤í–‰
    >> ì •ë¦¬ í•¨ìˆ˜ (clean-up Function)
    return() => {
    }
  },[ì˜ì¡´ì„± ë°°ì—´1, a, b, c]);

  VS ì´ë²¤íŠ¸ë¦¬ìŠ¤ë„ˆ
    domìš”ì†Œ.addEventListener(ì´ë²¤íŠ¸, ì½œë°±í•¨ìˆ˜);
    : ì´ë²¤íŠ¸ê°€ ë°œìƒí•˜ë©´ ì½œë°±í•¨ìˆ˜ ì‹¤í–‰
*/

function UseEffect01() {
  const [count, setCount] = useState<number>(0);
  const [name, setName] = useState<string>('ì´ìŠ¹ì•„');
  const [time, setTime] = useState<number>(0);

  // ë¶€ìˆ˜íš¨ê³¼ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì½œë°±í•¨ìˆ˜ëŠ” í•„ìˆ˜
  // ì˜ì¡´ì„± ë°°ì—´ì˜ ê²½ìš° ì„ íƒ >> ëª¨ë“  ë Œë”ë§ ë§ˆë‹¤ ì‹¤í–‰
  useEffect(() => {
    console.log(`Count: ${count}`);

    // countê°’ì˜ ìƒíƒœê°€ ë³€ê²½ë ë•Œë§Œ ë¶€ìˆ˜ íš¨ê³¼ê°€ ì‹¤í–‰
  }, [count]);

  useEffect(() => {
    console.log(`Name: ${name}`);
  }, [name]);

  useEffect(() => {
    // ë§ˆìš´íŠ¸ ì‹œì—ë§Œ ì‹¤í–‰ (ëª¨ë“  ìƒíƒœë³€í™”ì— ë°˜ì‘í•˜ì§€ ì•ŠìŒ)
    console.log('ì»´í¬ë„ŒíŠ¸ ë Œë”ë§');
  }, []);

  useEffect(() => {
    console.log(`== Name: ${name} / Count: ${count} == `);
  }, [name, count]);

  useEffect(() => {
    console.log('ğŸš—íƒ€ì´ë¨¸ ì‹œì‘');

    const timer = setInterval(() => {
      setTime(prev => prev + 1);
    }, 1000);

    return () => {
      clearInterval(timer);
      console.log('íƒ€ì´ë¨¸ ì •ë¦¬ë¨(ì»´í¬ë„ŒíŠ¸ê°€ ì‚¬ë¼ì§)');
    }
  }, []);

  return (
    <div>
      <button onClick={() => setCount((prevCount) => prevCount + 1)}>
        ì¦ê°€
      </button>
      <span>{count}</span>
      <button onClick={() => setCount((prevCount) => prevCount - 1)}>
        ê°ì†Œ
      </button>

      <br />

      <span>{name}</span>
      {/*
        í•´ë‹¹ ë²„íŠ¼ì˜ í´ë¦­ìœ¼ë¡œ ì»´í¬ë„ŒíŠ¸ ë‚´ì˜ ìƒíƒœ ë³€í™”ê°€ ì¼ì–´ë‚¨
        : useEffectì˜ ì˜ì¡´ì„± ë°°ì—´ì— countë§Œ ìˆëŠ” ë¶€ìˆ˜ íš¨ê³¼ëŠ” nameì˜ ë³€ê²½ì— ë°˜ì‘í•˜ì§€ x
       */}
      <button onClick={() => setName(name === 'ì´ìŠ¹ì•„' ?"ì´ë„ê²½" :"ì´ìŠ¹ì•„")}>ì´ë¦„ ë³€ê²½</button>

      <p>ì‹œê°„: {time}ì´ˆ</p>
    </div>
  );
}

export default UseEffect01;
